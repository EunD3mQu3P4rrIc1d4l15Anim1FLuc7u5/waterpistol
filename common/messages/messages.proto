syntax = "proto3";

package messages;

service Malware {
    rpc CheckCommandQueue (CheckCmdRequest) returns (CheckCmdReply) {}    
}

message ImplantReply {
    string module = 1;
    bytes args = 2;
}

message Exec {
    string Exec = 1;
    repeated string Args = 2;
}

message GetFile {
    string filename = 1;
}

message UploadFile {
    string filename = 1;
    bytes contents = 2;
}

// Implant -> C2
message CheckCmdRequest {
    oneof message {
        int64 heartbeat = 1;
        ImplantReply reply = 2;

    }
}

// C2 -> Implant
message CheckCmdReply {
    oneof message {
        int64 heartbeat = 1;
        Exec exec = 2;
        GetFile getfile = 3;
        UploadFile uploadfile = 4; 
    }
}
