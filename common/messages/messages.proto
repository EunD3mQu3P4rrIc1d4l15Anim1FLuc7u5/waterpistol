syntax = "proto3";

package messages;

service Malware {
    rpc CheckCommandQueue (CheckCmdRequest) returns (CheckCmdReply) {}    
}

message ImplantReply {
    string module = 1;
    repeated string args = 2;
}

message ExecReply {
    string reply = 1;
}

message FileReply {
    string file = 1;
}

// Implant -> C2
message CheckCmdRequest {
    oneof message {
        int64 heartbeat = 1;
        ImplantReply reply = 2;

    }
}

// C2 -> Implant
message CheckCmdReply {
    oneof message {
        int64 heartbeat = 1;
        ExecReply exec = 2;
        FileReply file = 3;
    }
}
